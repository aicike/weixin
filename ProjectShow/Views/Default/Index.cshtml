@{
    ViewBag.Menu = 1;
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}
@section head{
    <link href="@Url.Content("/Scripts/wowwindow/css/wowwindow.css")" rel="stylesheet"
    type="text/css" />
    <script src="@Url.Content("/Scripts/wowwindow/js/jquery.wowwindow.js")" type="text/javascript"></script>
    <script>
        $(function () {
            //Logo上传
            $("#btnUploadLogo").live("click", function () {
                $("#LogoImagePathFile").click();
            });
            $("#LogoImagePathFile").live("change", function () {
                var fileName = $("#LogoImagePathFile").val();
                $("#Logo").val(fileName);
                var suffix = fileName.substring(fileName.lastIndexOf('.')).toLowerCase();
                //$("span[data-valmsg-for='Logo']").empty().attr("class", "field-validation-valid");
                switch (suffix) {
                    case ".jpg":
                    case ".jpeg":
                    case ".gif":
                    case ".bmp":
                    case ".png":
                        break;
                    default:
                        // $("span[data-valmsg-for='Logo']").text("支持下列图片格式：.jpg|.jpeg|.gif|.bmp").attr("class", "field-validation-error");
                        break;
                }
                var input = this;
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $("#img_Logo").attr('src', e.target.result);
                    };
                    reader.readAsDataURL(input.files[0]);
                    reader.onload();
                }
                return false;
            });
            //背景上传
            $("#btnUploadBG").live("click", function () {
                $("#BGImagePathFile").click();
            });
            $("#BGImagePathFile").live("change", function () {
                var fileName = $("#BGImagePathFile").val();
                $("#BgImage").val(fileName);
                var suffix = fileName.substring(fileName.lastIndexOf('.')).toLowerCase();
                //$("span[data-valmsg-for='Logo']").empty().attr("class", "field-validation-valid");
                switch (suffix) {
                    case ".jpg":
                    case ".jpeg":
                    case ".gif":
                    case ".bmp":
                    case ".png":
                        break;
                    default:
                        // $("span[data-valmsg-for='Logo']").text("支持下列图片格式：.jpg|.jpeg|.gif|.bmp").attr("class", "field-validation-error");
                        break;
                }
                var input = this;
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $("#image_BG").attr('src', e.target.result);
                    };
                    reader.readAsDataURL(input.files[0]);
                    reader.onload();
                }
                return false;
            });

            //弹出层
            $('.popups a').wowwindow({
                draggable: true,
                testMode: false
            });
            //二维码
            $('a[rel=qrcode]').wowwindow({
                draggable: true,
                width: 425,
                testMode: false
            });



        });
        function divZZC_over(div) {
            $(div).find("div[class='div_c']").height($(div).height());
            $(div).find("div[class='div_c']").css("line-height", $(div).height() + "px")
            $(div).find("div[class='div_c']").show();
        }
        function divZZC_out(div) {
            $(div).find("div[class='div_c']").hide();
        }

        function DivQY() {
            $("#dialogShowQY").dialog({
                resizable: false,
                height: "auto",
                width: 450,
                modal: true,
                draggable: true,
                title: "图片",
                position: "center"
            });

        }

        function DivFX() {
            $("#dialogShowFX").dialog({
                resizable: false,
                height: "auto",
                width: 450,
                modal: true,
                draggable: true,
                title: "图片",
                position: "center"
            });

        }

        function DivBG() {
            $("#dialogShowBG").dialog({
                resizable: false,
                height: "auto",
                width: 450,
                modal: true,
                draggable: true,
                title: "图片",
                position: "center"
            });

        }


    </script>
    <style>
        .ui-widget-overlay
        {
            background: #f0f4fb !important;
        }
        .div_tj
        {
            width: 210px;
            height: 105px;
            background: #5bb4d8;
            color: #fff;
            float: left;
        }
        .div_tj_top
        {
            font-weight: bold;
            font-size: 25px;
            width: 165px;
            margin: 20px auto 20px auto;
        }
        .div_tj_bottom
        {
            font-size: 12px;
            width: 165px;
            margin: 0px auto;
        }
        .div_tjz
        {
            margin-left: 8px;
            width: 210px;
            height: 105px;
            background: #4fc2b9;
            color: #fff;
            float: left;
        }
        .div_ewm
        {
            margin-left: 8px;
            width: 210px;
            height: 105px;
            line-height: 105px;
            overflow: hidden;
            background: #f47564;
            color: #fff;
            float: left;
            cursor: pointer;
        }
        .Share
        {
            font-size: 14px;
            margin-bottom: 15px;
        }
        .div_fx
        {
            width: 210px;
            float: left;
            position: relative;
        }
        .div_fx_top
        {
            height: 70px;
            text-align: center;
            font-size: 18px;
            line-height: 70px;
            overflow: hidden;
        }
        .div_fx_bottom
        {
            background: #fff;
            min-height: 130px;
            text-align: center;
            font-size: 12px;
            padding: 15px 10px;
        }
        .div_c
        {
            background: #7a85a2;
            top: 0px;
            left: 0px;
            position: absolute;
            width: 100%;
            color: #fff;
            text-align: center;
            font-weight: bold;
            background-color: rgba(136,149,180,0.6);
            cursor: pointer;
            display: none;
            overflow: hidden;
        }
        .tab_fx
        {
            width: 100%;
            line-height: 18px;
        }
        .tab_fx td
        {
            border-bottom: 1px solid #d3d5e6;
            padding: 10px 0px;
        }
    </style>
}
@model Entity.EnterpriseInfo
<div class="Div_Title">
    首页
</div>
<div style="width: 100%; margin-bottom: 25px;">
    <div class="div_tj">
        <div class="div_tj_top">
            @Model.PreviewCnt.ToString("n")</div>
        <div class="div_tj_bottom">
            首页预览次数</div>
    </div>
    <div class="div_tjz">
        <div class="div_tj_top">
            @ViewBag.Count</div>
        <div class="div_tj_bottom">
            总预览次数</div>
    </div>
    <div class="popups">
        <a href="#example4" rel="qrcode">
            <div class="div_ewm">
                <div style="float: left; margin-top: 17px; margin-left: 10px; width: 70px; height: 70px;
                    background: #fff">
                    <img src="@Url.Action("GetQrCode", "Default")" style=" width:70px" />
                </div>
                <div style="float: right; font-size: 14px; margin-right: 10px">
                    点击查看分享地址
                </div>
            </div>
        </a>
    </div>
    <div style="clear: both">
    </div>
</div>
<div class="Share">
    分享配置选项
</div>
<div style="width: 100%; margin-bottom: 25px;">
    <div class="div_fx" onmouseover="divZZC_over(this)" onmouseout="divZZC_out(this)">
        <div class="div_fx_top" style="background: #e1e6ef">
            企业信息
        </div>
        <div class="div_fx_bottom">
            <table cellpadding="0" cellspacing="0" class="tab_fx">
                <tr>
                    <td align="center" colspan="2">
                        @if (string.IsNullOrEmpty(Model.Logo))
                        {
                            <img src="@Url.Content("/Image/logo.png")" style="max-width: 75%; max-height: 70px" />
                        }
                        else
                        {
                            <img src="@Url.Content(Model.Logo)" style="max-width: 75%; max-height: 70px" />
                        }
                    </td>
                </tr>
                <tr>
                    <td align="right" style="width: 60px; color: #b0bdd6">
                        公司简称:
                    </td>
                    <td align="left" style="padding-left: 5px; color: #6f7b91">
                        @Model.SName
                    </td>
                </tr>
            </table>
        </div>
        <a onclick="DivQY()">
            <div class="div_c">
                点击修改
            </div>
        </a>
    </div>
    <div class="div_fx" style="margin-left: 8px; background: #97a4c3;" onmouseover="divZZC_over(this)"
        onmouseout="divZZC_out(this)">
        <div class="div_fx_top" style="color: #fff">
            分享设置
        </div>
        <div class="div_fx_bottom">
            <table cellpadding="0" cellspacing="0" class="tab_fx">
                <tr style="">
                    <td align="right" style="width: 60px; color: #b0bdd6">
                        分享标题:
                    </td>
                    <td align="left" style="padding-left: 5px; color: #6f7b91">
                        @Model.ShareTitle
                    </td>
                </tr>
                <tr>
                    <td align="right" style="color: #b0bdd6">
                        分享备注:
                    </td>
                    <td align="left" style="padding-left: 5px; color: #6f7b91">
                        @Model.ShareRemark
                    </td>
                </tr>
                <tr>
                    <td align="right" style="color: #b0bdd6">
                        入口名称:
                    </td>
                    <td align="left" style="padding-left: 5px; color: #6f7b91">
                        @Model.ButtonName
                    </td>
                </tr>
            </table>
        </div>
        <a onclick="DivFX()">
            <div class="div_c">
                点击修改
            </div>
        </a>
    </div>
    <div class="div_fx" style="margin-left: 8px; background: #e1e6ef" onmouseover="divZZC_over(this)"
        onmouseout="divZZC_out(this)">
        <div class="div_fx_top">
            首页背景图片
        </div>
        <div class="div_fx_bottom">
            @if (string.IsNullOrEmpty(Model.BgImage))
            {
                <img src="@Url.Content("/Image/AppDefault.png")" style="max-width: 100%;" />
            }
            else
            {
                <img src="@Url.Content(Model.BgImage)" style="max-width: 100%; " />
            }
        </div>
        <a onclick="DivBG()">
            <div class="div_c">
                点击修改
            </div>
        </a>
    </div>
    <div style="clear: both">
    </div>
</div>
<div class="Share" style="display: none">
    报表展示
</div>
<div style="display: none;">
    <style>
        .div_exTitle
        {
            width: 100%;
            text-align: center;
            font-weight: bold;
            font-size: 20px;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        .tab_ex1
        {
            width: 100%;
            line-height: 18px;
            background: #fffeee;
        }
        .tab_ex1 td
        {
            width: 100%;
            line-height: 18px;
            height: 35px;
        }
    </style>
    <div id="example4">
        <div style="height: 430px">
            <div style="width: 100%; text-align: center; font-weight: bold; font-size: 20px;
                margin-top: 10px">
                手机扫描二维码</div>
            <img src="@Url.Action("GetQrCode", "Default")" style=" width:400px" />
        </div>
    </div>
</div>
<div id="dialogShowQY" title="" style="display: none">
    <div class="div_exTitle">
        企业信息</div>
    @using (Html.BeginForm("UpEnterpriseInfo", "Default", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <table cellpadding="0" cellspacing="0" class="Tab_info" style="font-size: 12px">
            <tr>
                <td style="width: 100px; height: 60px">
                    企业Logo:
                </td>
                <td>
                    @if (string.IsNullOrEmpty(Model.Logo))
                    {
                        <img id="img_Logo"  src="@Url.Content("/Image/logo.png")" style="max-width: 75%; max-height: 70px; float: left" />
                    }
                    else
                    {
                        <img id="img_Logo"  src="@Url.Content(Model.Logo)" style="max-width: 75%; max-height: 70px; float: left" />
                    }
                </td>
                <td valign="bottom">
                    <input type="file" id="LogoImagePathFile" name="LogoImagePathFile" style="display: none" />
                    <input type="button" class="input_button" value="选择" id="btnUploadLogo" style="margin-bottom: 5px" />
                    @Html.HiddenFor(a => a.Logo)
                </td>
            </tr>
            <tr>
                <td>
                    企业简称:
                </td>
                <td colspan="2">
                    @Html.TextBoxFor(a => a.SName, new { style = "width:85%" })
                </td>
            </tr>
        </table>
        <div>
            <input type="submit" id="sub_EnterpriseInfo" class="input_button" value="保存" />
        </div>
    }
</div>
<div id="dialogShowFX" title="" style="display: none">
    <div class="div_exTitle">
        分享设置</div>
    @using (Html.BeginForm("UpShareInfo", "Default", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <table cellpadding="0" cellspacing="0" class="Tab_info" style="font-size: 12px">
            <tr>
                <td style="width: 100px;">
                    分享标题:
                </td>
                <td>
                    @Html.TextBoxFor(a => a.ShareTitle, new { style = "width:85%" })
                </td>
            </tr>
            <tr>
                <td>
                    分享备注:
                </td>
                <td>
                    @Html.TextBoxFor(a => a.ShareRemark, new { style = "width:85%" })
                </td>
            </tr>
            <tr>
                <td>
                    入口名称:
                </td>
                <td>
                    @Html.TextBoxFor(a => a.ButtonName, new { style = "width:85%" })
                </td>
            </tr>
        </table>
        <div>
            <input type="submit" id="sub_ShareInfo" class="input_button" value="保存" />
        </div>
    }
</div>
<div id="dialogShowBG" title="" style="display: none">
    <div class="div_exTitle">
        首页背景图片</div>
    @using (Html.BeginForm("UpBgImage", "Default", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <table cellpadding="0" cellspacing="0" class="Tab_info" style="font-size: 12px">
            <tr>
                <td style="width: 1px">
                </td>
                <td>
                    @if (string.IsNullOrEmpty(Model.BgImage))
                    {
                        <img id="image_BG" src="@Url.Content("/Image/AppDefault.png")" style="max-width: 300px; max-height:300px" />
                    }
                    else
                    {
                        <img id="image_BG" src="@Url.Content(Model.BgImage)" style="max-width: 300px; max-height:300px " />
                    }
                </td>
                <td valign="bottom">
                    <input type="file" id="BGImagePathFile" name="BGImagePathFile" style="display: none" />
                    <input type="button" class="input_button" value="选择图片" id="btnUploadBG" style="margin-bottom: 5px" />
                    @Html.HiddenFor(a => a.BgImage)
                </td>
            </tr>
        </table>
        <div style="  color:#ff8463; margin-bottom:10px">
            为了更好的用户体验 请上传宽高比1:3以上的图片
        </div>
        <div>
            <input type="submit" id="sub_BgImage" class="input_button" value="保存" />
        </div>
    }
</div>
